<form #actionForm="ngForm">
    <ng-template #modal let-modal>
        <div class="modal-header">
            <h4 class="modal-title" id="modal-basic-title">Policy Change</h4>
            <div class="col-lg-5"></div>
            <br>
        </div>
        <div class="modal-body">
            <div>
                <label for="newEndorsementNumber">Endorsement Number</label>
                <input type="text" class="form-control" id="newEndorsementNumber" [required]="canEdit"
                    [readonly]="!canEdit" name="newEndorsementNumber" [(ngModel)]="endorsementActionInfo.newEndorsementNumber"
                    max="999" maxlength="3" (keyup)="checkEndorsementNumber()">
            </div>
            <div [hidden]="isNewEndorsementNumberValid" class="alert alert-danger">
                This Endorsement Number has already been used.
            </div>
            <div>
                <label for="transactionType">Transaction Type</label>
                <ng-select id="transactionType" [required]="canEdit" [items]="transactionTypes"
                    bindLabel="description" bindValue="key" [clearable]="false" [readonly]="!canEdit"
                    name="transactionType" [(ngModel)]="endorsementActionInfo.transactionType">
                </ng-select>
            </div>
            <div>
                <label for="endtReason">Endorsement Reason</label>
                <ng-select id="endtReason" [required]="canEdit" [items]="endorsementReasons"
                    bindLabel="description" bindValue="code" [clearable]="false" [readonly]="!canEdit" name="endtReason"
                    [(ngModel)]="endorsementActionInfo.endorsementReason">
                </ng-select>
            </div>
            <label for="transEffectiveDate">Transaction Effective Date</label>
            <input type="date" class="form-control" id="transEffectiveDate" [required]="canEdit" [readonly]="!canEdit"
                name="transEffectiveDate"  [ngModel]="endorsementActionInfo.transEffectiveDate   | date:'yyyy-MM-dd'"
                (blur)="checkTransEffectiveDate()" (ngModelChange)="endorsementActionInfo.transEffectiveDate=$event"
                #transEffectiveDate="ngModel">
            <div [hidden]="isTransEffectiveValid" class="alert alert-danger">
                Invalid Transactive Effective Date. Must be within policy period.
            </div>
            <label for="transExpirationDate">Transaction Expiration Date</label>
            <input type="date" class="form-control" id="transExpirationDate" [required]="canEdit" [readonly]="!canEdit"
                name="transExpirationDate" [ngModel]="endorsementActionInfo.transExpirationDate   | date:'yyyy-MM-dd'"
                (ngModelChange)="endorsementActionInfo.transExpirationDate=$event" #transEffectiveDate="ngModel"
                (change)="checkExpirationDate()">
            <div [hidden]="isTransExpirationValid" class="alert alert-danger">
                Invalid Transactive Expiration Date. 
            </div>
            <div>
                <label for="premium">Premium</label>
                <input type="text" class="form-control" id="premium" [required]="canEdit" [readonly]="!canEdit"
                    name="premium" [(ngModel)]="endorsementActionInfo.premium" #premium="ngModel" mask="separator.0"
                    thousandSeparator=",">
            </div>
        </div>
        <div class="modal-footer">           
             <button type="button" class="btn btn-danger" (click)="submit()" [disabled]="!actionForm.form.valid">Submit</button>
                <button type="button" class="btn btn-secondary" (click)="clearAndClose()" >Cancel</button>
        </div>
    </ng-template>
    <div *ngIf="showBusy">
        <rsps-busy></rsps-busy>
      </div>
      
      <ng-template #modalPipe let-modal>
        <div class="modal-header">
          <h4 class="modal-title" id="modal-basic-title">Error Creating Endorsement</h4>
        </div>
        <div class="modal-body">
          <p>{{pipeMessage}}</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-danger" (click)="modal.close('Save click')">Close</button>
        </div>
      </ng-template>