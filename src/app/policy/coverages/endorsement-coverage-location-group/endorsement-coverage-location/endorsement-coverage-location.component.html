<form #locationForm="ngForm">
  <ng-template #modal let-modal >
    <div class="modal-header" [ngClass]="confirmation">
      <h4 class="modal-title" id="modal-basic-title">Location</h4>
    </div>
    <div class="modal-body" [ngClass]="confirmation"> 
      <div class="col-md" [hidden]="!showLocationId">
        <label for="street">Location Id:</label>
        <input type="text" class="form-control" id="locationId" [readonly]="true" [(ngModel)]="location.locationId"
          name="locationId" #locationId="ngModel">
      </div>
      <div class="col-md">
        <label for="street">Address Street 1</label>
        <input type="text" class="form-control" id="street" [readonly]="!canEdit"
          maxlength="40" [(ngModel)]="location.street" name="street" #street="ngModel">
      </div>
      <div class="col-md">
        <label for="street2">Addres Street 2</label>
        <input type="text" class="form-control" id="street2" [readonly]="!canEdit" [(ngModel)]="location.street2"
          maxlength="40" name="street2" #street2="ngModel">
      </div>
      <div class="col-md">
        <label for="zipCode">Zip Code</label>
        <input type="text" class="form-control" id="zipCode" [readonly]="!canEdit" [required]="canEdit"
          mask="00000||00000-0000" [(ngModel)]="location.zip" name="zipCode" #zip="ngModel"
          (ngModelChange)="changeZipCode()">
      </div>
      <div class="col-md">
        <label for="city">City</label>
        <div *ngIf="isLoadingAddress">
          <div class="spinner-border ml-auto" role="status" aria-hidden="true">
          </div>
        </div>
        <div *ngIf="!isLoadingAddress">
          <input type="text" class="form-control" id="city" [readonly]="!canEdit || isLoadingAddress"
            maxlength="25" [required]="canEdit" [(ngModel)]="location.city" name="city" #city="ngModel">
        </div>
      </div>
      <div class="col-md">
        <label for="locationState">State</label>
        <div *ngIf="isLoadingAddress">
          <div class="spinner-border ml-auto" role="status" aria-hidden="true">
          </div>
        </div>
        <div *ngIf="!isLoadingAddress">
          <ng-select id="locationState" [items]="states$ | async" bindLabel="description" bindValue="code"
            [clearable]="false" [readonly]="!canEdit || isLoadingAddress"
            name="locationState" [required]="canEdit" [(ngModel)]="location.state" #locationState="ngModel">
          </ng-select>
        </div>
      </div>
      <div class="col-md">
        <label for="locationCounty">County</label>
        <div *ngIf="isLoadingAddress">
          <div class="spinner-border ml-auto" role="status" aria-hidden="true">
          </div>
        </div>
        <div *ngIf="!isLoadingAddress">
          <div *ngIf="counties.length <= 1">
            <input type="text" class="form-control" id="locationCounty" [readonly]="!canEdit || isLoadingAddress"
              maxlength="100" [(ngModel)]="location.county" name="locationCounty" #locationCounty="ngModel">
          </div>
          <div *ngIf="counties.length > 1">
            <ng-select id="locationCounty" [items]="counties" [clearable]="false"
              [readonly]="!canEdit || isLoadingAddress" name="locationCounty" [(ngModel)]="location.county"
              #locationCounty="ngModel">
            </ng-select>
          </div>
        </div>
      </div>
    </div>
    <div class="modal-footer" [ngClass]="confirmation">
      <button type="button" class="btn btn-primary" [hidden]="!canEdit"
        [disabled]="!locationForm.valid || !isDirty || isLoadingAddress" (click)="save()">Save</button>
      <button type="button" class="btn btn-danger" [hidden]="!canEdit || !canDeleteLocation" [disabled]="isLoadingAddress"
        (click)="openDeleteConfirmation()">Delete</button>
      <button type="button" class="btn btn-secondary" [hidden]="!canEdit" (click)="cancel()">Cancel</button>
      <button type="button" class="btn btn-secondary" [hidden]="canEdit" (click)="cancel()">Close</button>
    </div>
  </ng-template>


  <ng-template #modalConfirmation let-modal>
    <div class="modal-header">
      <h4 class="modal-title" id="modal-basic-title">Delete Location Confirmation</h4>
      <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
        <span aria-hidden="true">Ã—</span>
      </button>
    </div>
    <div class="modal-body">
      <p>Are you sure you want to delete this location and all coverages?</p>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-danger" (click)="modal.close('Yes')">Yes</button>
      <button type="button" class="btn btn-secondary" (click)="modal.close()">No</button>
    </div>
  </ng-template>