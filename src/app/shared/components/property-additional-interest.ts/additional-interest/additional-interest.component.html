<div class="component-row" (mouseover)="!canDrag ? isHover = true: isHover = false" (mouseleave)="isHover = false">
  <div [ngClass]="collapsed ? 'collapsed' : 'expanded'">
    <div>
      <div class="row" *ngIf="collapsed">
        <div class="col-lg-1">
          <ng-select class="max-width" id="building" [items]="buildingList" bindLabel="description" bindValue="code"
            name="building" [virtualScroll]="true" click-stop-propagation [clearable]="false" [required]="canEdit"
            [searchFn]="dropDownSearch" [(ngModel)]="aiData.building">
            <ng-template ng-label-tmp let-item="item">
              {{item.code}}
            </ng-template>
            <ng-template ng-option-tmp let-item="item">
              {{item.description}}
            </ng-template>
          </ng-select>
        </div>
        <div (click)="collapseExpand(false)" class="col-lg-6">
          <input validate-on-change type="address" class="form-control" id="address" #address="ngModel" name="address"
            [readonly]="!canEdit" [ngModel]=" (!aiData.interest? '' : aiData.interest) +
                          (!aiData.street1 ? '' : ', ' + aiData.street1) +
                          (!aiData.street2 ? '' : ', ' + aiData.street2) +
                          (!aiData.city ? '' : ', ' + aiData.city ) +
                          (!aiData.state ? '' : ', ' + aiData.state) +
                          (!aiData.zip ? '' : ' ' + aiData.zip)">
        </div>
        <div class="col-lg-2">
          <button class="btn btn-secondary" (click)=copyAdditionalInterest() hover-class="btn-primary"
            [disabled]="!canEdit" click-stop-propagation>Copy</button>&nbsp;
          <button *ngIf="!aiData.isNew" class="btn btn-secondary margin-left" (click)=openDeleteConfirmation()
            [disabled]="!canEdit" hover-class="btn-danger" click-stop-propagation>Delete</button>
          <button *ngIf="aiData.isNew" class="btn btn-secondary margin-left" (click)=openDeleteConfirmation()
            [disabled]="!canEdit" hover-class="btn-warning" click-stop-propagation>Remove</button>
        </div>
      </div>
    </div>
    <div #collapse="ngbCollapse" [(ngbCollapse)]="collapsed">
      <div class="row">
        <div class="col-lg-1">
          <label for="building" class="form-label" title="building">Prem/Bldg:</label>
          <ng-select class="max-width" id="building" [items]="buildingList" bindLabel="description" bindValue="code"  [readonly]="!canEdit"
            name="building" [virtualScroll]="true" click-stop-propagation [clearable]="false" [required]="canEdit"
            [searchFn]="dropDownSearch" [(ngModel)]="aiData.building">
            <ng-template ng-label-tmp let-item="item">
              {{item.code}}
            </ng-template>
            <ng-template ng-option-tmp let-item="item">
              {{item.description}}
            </ng-template>
          </ng-select>
        </div>
        <div class="col-lg-2">
          <label for="mortgageType" class="form-label" title="additionalInterestType">Additional Interest Type</label>
          <ng-select id="additionalInterestType" [items]="additionalInterestRoles$ | async" bindLabel="description" bindValue="key" [clearable]="false"
          [readonly]="!canEdit" [required]="canEdit" name="additionalInterestType" [(ngModel)]="aiData.additionalInterestType"
           #aiType="ngModel" >
          </ng-select>
        </div>
        <div class="col-sm-3">
          <label for="interest" class="form-label" title="interest">Interest</label>
          <input validate-on-change type="text" class="form-control" id="policyEventCode" name="interest" [readonly]="!canEdit"
          [required]="canEdit" [(ngModel)]="aiData.interest" #interest="ngModel">
        </div>
        <div class="col-sm-3">
          <label for="street1" class="form-label" title="Status">Street Address 1</label>
          <input validate-on-change type="text" class="form-control" id="street1" name="street1" [readonly]="!canEdit" maxlength="40"
          [required]="canEdit" [(ngModel)]="aiData.street1" #street1="ngModel">
        </div>
        <div class="col-sm-3">
          <label for="street2" class="form-label" title="Status">Street Address 2</label>
          <input validate-on-change type="text" class="form-control" id="street2" name="street2" [readonly]="!canEdit" maxlength="40"
            [(ngModel)]="aiData.street2" #street2="ngModel">
        </div>
        <div class="row">
          <div class="col-sm-2">
            <label for="zip" class="form-label" title="zip">Zipcode</label>
            <div class="inputspinner">
              <input validate-on-change type="text" zip-code class="form-control" id="zipCode" [readonly]="aiData.isZipLookup"
                [(ngModel)]="aiData.zip" [readonly]="!canEdit" name="zipCode" #zip="ngModel"
                [required]="canEdit" (ngModelChange)="changeZipCode()">
              <div *ngIf="aiData.isZipLookup" id="spinner" class="spinner-border spinner-border-sm" role="zipCode"
                aria-hidden="true">
              </div>
            </div>
          </div>
          <div class="col-sm-3">
            <label for="city" class="form-label" title="city">City</label>
            <input validate-on-change type="text" class="form-control" id="city" name="city" [(ngModel)]="aiData.city" maxlength="40"
            [required]="canEdit" [readonly]="aiData.isZipLookup || !canEdit" #city="ngModel">
          </div>
          <div class="col-sm-2">
            <label for="policyEventCode" class="form-label" title="Status">State</label>
            <div *ngIf="isLoadingAddress">
              <div class="spinner-border ml-auto" role="status" aria-hidden="true">
              </div>
            </div>
            <div *ngIf="!isLoadingAddress">
              <ng-select id="mortgageeState" [items]="states$ | async" bindLabel="name" bindValue="code"
                [clearable]="false" [readonly]="!canEdit || aiData.isZipLookup" name="mortgageeState"  [readonly]="!canEdit"
                [required]="canEdit"  [(ngModel)]="aiData.state" #mortgageeState="ngModel" (change)="changeState($event)">
              </ng-select>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-2">
            <label for="attention" class="form-label" title="attention">Attention</label>
            <input validate-on-change type="text" class="form-control" id="policyEventCode" name="attention"
              [readonly]="!canEdit" [(ngModel)]="aiData.attention" #attention="ngModel">
          </div>
          <div class="col-sm-8">
            <label for="comments" class="form-label" title="comments">Additional Interest Description</label>
            <input validate-on-change type="text" class="form-control" id="comments" name="comments" [readonly]="!canEdit"
              [(ngModel)]="aiData.description" #comments="ngModel">
          </div>
        </div>
      </div>
      <div class="empty-row"></div>
      <div class="row">
        <div class="col-lg-2">
          <button class="btn btn-secondary" (click)=copyAdditionalInterest() hover-class="btn-primary"
            [disabled]="!canEdit">Copy</button>&nbsp;
          <button *ngIf="!aiData.isNew" class="btn btn-secondary margin-left" (click)=openDeleteConfirmation()
            [disabled]="!canEdit" hover-class="btn-danger">Delete</button>
          <button *ngIf="aiData.isNew" class="btn btn-secondary margin-left" (click)=openDeleteConfirmation()
            [disabled]="!canEdit" hover-class="btn-warning">Remove</button>
        </div>
        <div [id]='anchorId'></div>
      </div>
      <button *ngIf="!collapsed" class="collapse-bar" (click)="collapseExpand(true)" ngbTooltip="Collapse"
        [openDelay]="1000">
        <fa-icon [icon]="faArrowUp"></fa-icon>
      </button>
    </div>
  </div>
</div>
